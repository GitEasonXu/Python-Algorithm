# 设计模式

## 1 定义

设计模式：对软件设计中普遍存在的各种问题，所提出的解决方案。每一个设计模式系统地命名、解释和评价了面向对象系统中一个重要的和重复出现的设计。

- 因此软件设计中问题的定义很重要，有了问题定义后找到对应的解决方案即可。
- 设计模式解决的是面向对象系统中的设计。

面向对象的三大特性：

- 封装
- 继承
- 多态

接口：若干抽象方法的集合，它的作用限制实现接口的类必须按照接口给定的调用方式实现这些方法，对高层模块隐藏了类的内部实现。

接口定义了方法(模板), 子类完成实现, 保证了一致性。

面向对象设计SOLID原则

- 开放封闭原则：一个软件实体如类、模块和函数应该对扩展开放，对修改关闭。即软件实体应尽量在不修改原有代码的情况下进行扩展。

- 里氏替换原则：所有引用父类的地方必须能透明的使用其子类的对象。举例：User父类，VIPUser是子类，一个函数接收User可以正常运行，那么接受VIPUser也应该能正常运行。

- 依赖倒置原则：高层模块不应该依赖底层模块，二者都应该依赖其抽象；抽象不应该依赖细节；细节应该依赖抽象。换言之，要针对接口编程，而不是针对实现编程。

  高层模块不应该依赖底层模块：因为如果底层模块修改了，那么高层也就相应的需要修改。

  二者都应该依赖其抽象：接口是抽象的，高层模块按照接口定义实现业务逻辑调用，底层模块按照接口实现过程。

- 接口隔离原则：使用多个专用的接口，而不使用单一的总接口，即子类不应该依赖那些它不需要的接口。子类直接继承总接口，但是子类没有必要实现总接口的一些方法，那么此时需要对总接口进行拆分。

- 单一职责原则：不要存在多于一个导致类变更的原因。通俗说就是一个类只负责一项职责。

设计模式分类：

- 创建型模式：工厂方法模式、抽象工厂模式、创建者模式、原型模式、单例模式。
- 结构型模式：适配器模式、桥接模式、组合模式、装饰模式、外观模式、享元模式、代理模式。
- 行为型模式：解释器模式、责任链模式、命令模式、迭代器模式、中介者模式、备忘录模式、观察者模式、状态模式、策略模式、访问者模式、模板方法模式。

## 2.创建型模式

### 2.1简单工厂模式

定义：不直接向客户端暴露对象创建的实现细节，而是通过一个工厂类来负责创建产品类的实例。

角色：

- 工厂角色(Creator)：
- 抽象产品角色(Product):
- 具体产品角色(Concrete Product):

优点：

- 隐藏了对象创建的实现细节
- 客户端不需要修改代码

缺点：

- 违反了单一职责原则，将创建逻辑写到了一个工厂类里。
- 当添加新产品时，需要修改工厂类代码，违反了开闭原则。重点：增加新的产品时，需要在工厂类里将新产品类的实例化包含进去。

### 2.2工厂方法模式

定义：定义一个用于创建对象的接口(工厂接口)，让子类决定实例化哪些一个产品类。

角色：

- 抽象工厂角色(Creator)：工厂接口
- 具体工厂角色(Concrete Creator): 根据工厂接口，实现不同的工厂角色，不同的工厂角色用于生产不同类的实例化
- 抽象产品角色(Product):类的抽象接口
- 具体产品角色(Concrete Product):类的实现

优点：

- 每个具体产品都对应一个具体工厂类，不需要修改工厂类代码。
- 隐藏了对象创建的实现细节。

缺点：

- 每增加一个具体产品类，就必须增加一个相应的具体工厂类。

### 2.3抽象工厂模式

定义：定义一个工厂类接口，让工厂子类来创建一系列相关或相互依赖的对象，相比工厂方法模式，抽象工厂模式中的每个具体工厂都生产一套产品。

例如：生产一部手机，需要手机壳、CPU、操作系统三类对象，其中每类对象都有不同的种类。对每个具体工厂，分别生产一部手机所需要的三个对象。

角色：

- 抽象工厂角色(Creator)：
- 具体工厂角色(Concrete Creator):
- 抽象产品角色(Product)：
- 具体产品角色(Concrete Product)：
- 客户端

优点：

- 将客户端与类的具体实现相分离
- 每个工厂创建了一个完整的产品系列，使得易于交换产品系列
- 有利于产品的一致性（即产品之间的约束关系）

缺点：

- 难以支持新种类的(抽象)产品

### 2.4建造者模式

定义：将一个复杂对象的构建与它的表示分离，使得同样的构建过程可以创建不同的表示。

角色：

- 抽象建造者(Builder):
- 具体建造者(Concrete Builder):
- 指挥者(Director):
- 产品(Product):

建造者模式与抽象工厂模式相似，也用来创建复杂对象。主要区别是建造者模式着重一步步构造一个复杂对象，而抽象工厂模式着重于多个系列的产品对象。

优点：

- 隐藏了一个产品的内部结构和装配过程
- 将构造代码与表示代码分开
- 可以对构造过程进行更精细的控制

